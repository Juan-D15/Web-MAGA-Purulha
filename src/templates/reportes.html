{% extends 'base.html' %}
{% load static %}

{% block title %}Reportes — MAGA Purulhá{% endblock %}

{% block header_subtitle %}Reportes y Estadísticas{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/reportes.css' %}?v=3.23">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
{% endblock %}

{% block content %}
<!-- ======= MAIN CONTENT ======= -->
<main class="reportes-main">
  <div class="reportes-container">
    
    <!-- ======= SECCIÓN 1: DASHBOARD EJECUTIVO ======= -->
    <section class="dashboard-section" id="dashboardSection">
      <div class="dashboard-header-container">
        <h2 class="section-title">Dashboard Ejecutivo</h2>
        <button class="btn-reporte-general" onclick="openReporteGeneral()">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
          </svg>
          <span class="btn-reporte-text">Generar Reporte General</span>
        </button>
      </div>
      
      <!-- Tarjetas de Métricas Principales -->
      <div class="metrics-grid" id="metricsGrid">
        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
          </div>
          <div class="metric-content">
            <h3 class="metric-value" id="metricTotalActividades">-</h3>
            <p class="metric-label">Total de Actividades</p>
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
              <circle cx="12" cy="10" r="3"></circle>
            </svg>
          </div>
          <div class="metric-content">
            <h3 class="metric-value" id="metricComunidades">-</h3>
            <p class="metric-label">Comunidades Alcanzadas</p>
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
          </div>
          <div class="metric-content">
            <h3 class="metric-value" id="metricTrabajadores">-</h3>
            <p class="metric-label">Trabajadores Activos</p>
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
          </div>
          <div class="metric-content">
            <h3 class="metric-value" id="metricBeneficiarios">-</h3>
            <p class="metric-label">Beneficiarios Alcanzados</p>
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          </div>
          <div class="metric-content">
            <h3 class="metric-value" id="metricCompletadasMes">-</h3>
            <p class="metric-label">Completadas este Mes</p>
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
          </div>
          <div class="metric-content">
            <h3 class="metric-value" id="metricPendientes">-</h3>
            <p class="metric-label">Actividades Pendientes</p>
          </div>
        </div>
      </div>

      <!-- Gráficos Principales -->
      <div class="charts-grid">
        <div class="chart-card">
          <h3 class="chart-title">Actividades por Mes</h3>
          <div class="chart-container">
            <canvas id="chartActividadesMes"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <h3 class="chart-title">Distribución por Tipo</h3>
          <div class="chart-container">
            <canvas id="chartPorTipo"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <h3 class="chart-title">Actividades por Región (Top 5)</h3>
          <div class="chart-container">
            <canvas id="chartPorRegion"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <h3 class="chart-title">Estado de Actividades</h3>
          <div class="chart-container">
            <canvas id="chartEstado"></canvas>
          </div>
        </div>
      </div>

      <!-- Tablas Resumen -->
      <div class="tables-grid">
        <div class="table-card">
          <h3 class="table-title">Top 5 Comunidades Más Activas</h3>
          <div class="table-container">
            <table class="results-table" id="tableComunidadesActivas">
              <thead>
                <tr>
                  <th>Comunidad</th>
                  <th>Región</th>
                  <th>Total Actividades</th>
                  <th>Última Actividad</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="4" class="loading-cell">Cargando datos...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="table-card">
          <h3 class="table-title">Top 5 Responsables Más Productivos</h3>
          <div class="table-container">
            <table class="results-table" id="tableResponsables">
              <thead>
                <tr>
                  <th>Responsable</th>
                  <th>Puesto</th>
                  <th>Completadas</th>
                  <th>En Progreso</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="4" class="loading-cell">Cargando datos...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="table-card">
          <h3 class="table-title">Próximas Actividades (7 días)</h3>
          <div class="table-container">
            <table class="results-table" id="tableProximas">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>Fecha</th>
                  <th>Comunidad</th>
                  <th>Estado</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="4" class="loading-cell">Cargando datos...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- ======= SECCIÓN 2: TARJETAS DE REPORTES ======= -->
    <section class="reports-section" id="reportsSection">
      <h2 class="section-title">Reportes Disponibles</h2>

      <!-- Categoría 1: Reportes por Ubicación -->
      <div class="category-section">
        <h3 class="category-title">Reportes por Ubicación</h3>
        <div class="reports-grid">
          <div class="report-card" data-report-type="actividades-por-region-comunidad">
            <div class="card-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
              </svg>
            </div>
            <h4 class="card-title">Actividades por Región o Comunidad</h4>
            <p class="card-description">Reporte detallado de actividades agrupadas por región o comunidad</p>
            <button class="card-button">Generar Reporte</button>
          </div>

          <div class="report-card" data-report-type="beneficiarios-por-region-comunidad">
            <div class="card-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
            </div>
            <h4 class="card-title">Beneficiarios por Región o Comunidad</h4>
            <p class="card-description">Reporte detallado de beneficiarios agrupados por región o comunidad</p>
            <button class="card-button">Generar Reporte</button>
          </div>
        </div>
      </div>

      <!-- Categoría 2: Reportes de Personal -->
      <div class="category-section">
        <h3 class="category-title">Reportes de Personal</h3>
        <div class="reports-grid">
          <div class="report-card" data-report-type="actividad-de-personal">
            <div class="card-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
            </div>
            <h4 class="card-title">Actividad de Personal</h4>
            <p class="card-description">Actividades y avances realizados por colaboradores</p>
            <button class="card-button">Generar Reporte</button>
          </div>
        </div>
      </div>

      <!-- Categoría 3: Reportes de Avances -->
      <div class="category-section">
        <h3 class="category-title">Reportes de Avances</h3>
        <div class="reports-grid">
          <div class="report-card" data-report-type="avances-eventos-generales">
            <div class="card-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
              </svg>
            </div>
            <h4 class="card-title">Avances de Eventos Generales</h4>
            <p class="card-description">Listado de avances con descripción y evidencias</p>
            <button class="card-button">Generar Reporte</button>
          </div>

          <div class="report-card" data-report-type="reporte-evento-individual">
            <div class="card-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </div>
            <h4 class="card-title">Reporte de Evento Individual</h4>
            <p class="card-description">Detalles completos de un evento con avances y evidencias</p>
            <button class="card-button">Generar Reporte</button>
          </div>
        </div>
      </div>

      <!-- Categoría 6: Reportes de Comunidades -->
      <div class="category-section">
        <h3 class="category-title">Reportes de Comunidades</h3>
        <div class="reports-grid">
          <div class="report-card" data-report-type="comunidades">
            <div class="card-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
              </svg>
            </div>
            <h4 class="card-title">Comunidades</h4>
            <p class="card-description">Comunidades alcanzadas con proyectos, estadísticas generales de comunidades</p>
            <button class="card-button">Generar Reporte</button>
          </div>
        </div>
      </div>

      <!-- Categoría 5: Reportes de Auditoría -->
      <div class="category-section">
        <h3 class="category-title">Reportes de Auditoría</h3>
        <div class="reports-grid">
          <div class="report-card" data-report-type="actividad-usuarios">
            <div class="card-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
            </div>
            <h4 class="card-title">Actividad de Usuarios</h4>
            <p class="card-description">Registro de actividad y cambios realizados por usuarios en el sistema</p>
            <button class="card-button">Generar Reporte</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ======= SECCIÓN 3: PANEL DE FILTROS Y RESULTADOS ======= -->
    <section class="results-section" id="resultsSection" style="display: none;">
      <div class="results-header">
        <button class="btn-back" id="backFromResultsBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"></path>
          </svg>
          Volver
        </button>
        <h2 class="results-title" id="resultsTitle">Resultados del Reporte</h2>
      </div>

      <!-- Panel de Filtros - Formularios específicos por tipo de reporte -->
      <div class="filters-panel" id="filtersPanel">
        <div class="filters-header">
          <h3 class="filters-title">Filtros</h3>
          <button class="filters-toggle" id="filtersToggle">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="18 15 12 9 6 15"></polyline>
            </svg>
          </button>
        </div>
        <div class="filters-content" id="filtersContent">
          <!-- Formulario: Actividades por Región o Comunidad -->
          <div class="report-form" id="form-actividades-por-region-comunidad" style="display: none;">
            <div class="filters-grid">
              <div class="filter-group filter-group-full">
                <label class="filter-label">Agrupar por</label>
                <div class="switch-container">
                  <label class="switch">
                    <input type="checkbox" id="switchAgruparActividades">
                    <span class="switch-slider"></span>
                  </label>
                  <span class="switch-label" id="switchLabelActividades">Región</span>
                </div>
              </div>
              
              <div class="filter-group filter-group-full">
                <label class="filter-label">Período de Fechas</label>
                <div class="date-selector">
                  <select class="filter-select" id="filterPeriodoActividades">
                    <option value="ultimo_mes">Último mes</option>
                    <option value="ultima_semana">Esta última semana</option>
                    <option value="rango">Rango de fechas</option>
                  </select>
                </div>
                <div class="date-range-container" id="dateRangeActividades" style="display: none;">
                  <div class="filter-group">
                    <label class="filter-label">Fecha Inicio</label>
                    <input type="date" class="filter-input" id="filterFechaInicioActividades">
                  </div>
                  <div class="filter-group">
                    <label class="filter-label">Fecha Fin</label>
                    <input type="date" class="filter-input" id="filterFechaFinActividades">
                  </div>
                </div>
              </div>
              
              <div class="filter-group filter-group-full">
                <label class="filter-label">Estado del Evento</label>
                <div class="filter-checkboxes" id="filterEstadoActividades">
                  <label><input type="checkbox" value="planificado" checked> Planificado</label>
                  <label><input type="checkbox" value="en_progreso" checked> En Progreso</label>
                  <label><input type="checkbox" value="completado" checked> Completado</label>
                  <label><input type="checkbox" value="cancelado" checked> Cancelado</label>
                </div>
              </div>
              
              <div class="filter-group filter-group-full">
                <label class="filter-label">Tipo de Actividad</label>
                <select class="filter-select" id="filterTipoActividadActividades" multiple>
                  <option value="">Cargando...</option>
                </select>
              </div>
              
              <div class="filter-group filter-group-full">
                <label class="filter-label">Buscar Comunidad</label>
                <div class="search-input-container">
                  <input type="text" class="filter-input filter-search" id="searchComunidadActividades" placeholder="Buscar comunidades...">
                  <div class="search-results" id="searchResultsActividades" style="display: none;"></div>
                </div>
              </div>
            </div>
            <div class="filters-actions">
              <button class="btn-secondary" onclick="resetFiltersForm('actividades-por-region-comunidad')">Limpiar Filtros</button>
              <button class="btn-primary" onclick="applyFiltersForm('actividades-por-region-comunidad')">Aplicar Filtros</button>
            </div>
          </div>
          
          <!-- Formulario: Beneficiarios por Región o Comunidad -->
          <div class="report-form" id="form-beneficiarios-por-region-comunidad" style="display: none;">
            <div class="filters-grid">
              <div class="filter-group filter-group-full">
                <label class="filter-label">Agrupar por</label>
                <div class="switch-container">
                  <label class="switch">
                    <input type="checkbox" id="switchAgruparBeneficiarios">
                    <span class="switch-slider"></span>
                  </label>
                  <span class="switch-label" id="switchLabelBeneficiarios">Región</span>
                </div>
              </div>
              
              <div class="filter-group filter-group-full">
                <label class="filter-label">Período de Fechas</label>
                <div class="date-selector">
                  <select class="filter-select" id="filterPeriodoBeneficiarios">
                    <option value="ultimo_mes">Último mes</option>
                    <option value="ultima_semana">Esta última semana</option>
                    <option value="rango">Rango de fechas</option>
                  </select>
                </div>
                <div class="date-range-container" id="dateRangeBeneficiarios" style="display: none;">
                  <div class="filter-group">
                    <label class="filter-label">Fecha Inicio</label>
                    <input type="date" class="filter-input" id="filterFechaInicioBeneficiarios">
                  </div>
                  <div class="filter-group">
                    <label class="filter-label">Fecha Fin</label>
                    <input type="date" class="filter-input" id="filterFechaFinBeneficiarios">
                  </div>
                </div>
              </div>
              
              <div class="filter-group filter-group-full">
                <label class="filter-label">Tipo de Actividad</label>
                <select class="filter-select" id="filterTipoActividadBeneficiarios" multiple>
                  <option value="">Cargando...</option>
                </select>
              </div>
              
              <div class="filter-group filter-group-full">
                <label class="filter-label">Tipo de Beneficiario</label>
                <div class="filter-checkboxes" id="filterTipoBeneficiarioBeneficiarios">
                  <label><input type="checkbox" value="individual" checked> Individual</label>
                  <label><input type="checkbox" value="familia" checked> Familia</label>
                  <label><input type="checkbox" value="institución" checked> Institución</label>
                  <label><input type="checkbox" value="otro" checked> Otro</label>
                </div>
              </div>
              
              <div class="filter-group filter-group-full">
                <label class="filter-label">Buscar Comunidad</label>
                <div class="search-input-container">
                  <input type="text" class="filter-input filter-search" id="searchComunidadBeneficiarios" placeholder="Buscar comunidades...">
                  <div class="search-results" id="searchResultsBeneficiarios" style="display: none;"></div>
                </div>
              </div>
              
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Filtrar por Evento</label>
                  <span class="toggle-icon" id="toggleIconEventosBeneficiarios" style="cursor: pointer;" onclick="toggleChecklist('eventosBeneficiarios')">▶</span>
                </div>
                <!-- Tags de eventos seleccionados (siempre visibles) -->
                <div id="selectedEventosBeneficiariosTags" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;">
                  <!-- Los eventos seleccionados aparecerán aquí como tags -->
                </div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchEventoBeneficiarios" placeholder="Buscar evento...">
                </div>
                <div id="eventosBeneficiariosContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterEventosBeneficiarios" style="max-height: 200px; overflow-y: auto;">
                    <!-- Los eventos NO seleccionados se cargarán aquí dinámicamente -->
                  </div>
                </div>
              </div>
            </div>
            <div class="filters-actions">
              <button class="btn-secondary" onclick="resetFiltersForm('beneficiarios-por-region-comunidad')">Limpiar Filtros</button>
              <button class="btn-primary" onclick="applyFiltersForm('beneficiarios-por-region-comunidad')">Aplicar Filtros</button>
            </div>
          </div>
          
          <!-- Formulario: Actividad de Personal - V3.1 SIMPLIFICADO -->
          <div class="report-form" id="form-actividad-de-personal" style="display: none;">
            <div class="filters-grid">
              <!-- Período de Fechas -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Período de Fechas</label>
                <select class="filter-select" id="filterPeriodoPersonal">
                  <option value="todo">Todo el tiempo</option>
                  <option value="ultimo_mes">Último mes</option>
                  <option value="ultima_semana">Esta última semana</option>
                  <option value="rango">Rango de fechas</option>
                </select>
                <div class="date-range-container" id="dateRangePersonal" style="display: none; margin-top: 12px;">
                  <div class="filter-group">
                    <label class="filter-label">Fecha Inicio</label>
                    <input type="date" class="filter-input" id="filterFechaInicioPersonal">
                  </div>
                  <div class="filter-group">
                    <label class="filter-label">Fecha Fin</label>
                    <input type="date" class="filter-input" id="filterFechaFinPersonal">
                  </div>
                </div>
              </div>
              
              <!-- Buscar Comunidad -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Buscar Comunidad</label>
                <div class="search-input-container">
                  <input type="text" class="filter-input filter-search" id="searchComunidadPersonal" placeholder="Buscar comunidades...">
                  <div class="search-results" id="searchResultsComunidadPersonal" style="display: none;"></div>
                </div>
              </div>
              
              <!-- Filtrar por Evento -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Filtrar por Evento</label>
                  <span class="toggle-icon" id="toggleIconEventosPersonal" style="cursor: pointer;" onclick="toggleChecklist('eventosPersonal')">▶</span>
                </div>
                <!-- Tags de eventos seleccionados (siempre visibles) -->
                <div id="selectedEventosPersonalTags" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;">
                  <!-- Los eventos seleccionados aparecerán aquí como tags -->
                </div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchEventoPersonal" placeholder="Buscar evento...">
                </div>
                <div id="eventosPersonalContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterEventosPersonal" style="max-height: 200px; overflow-y: auto;">
                    <!-- Los eventos NO seleccionados se cargarán aquí dinámicamente -->
                  </div>
                </div>
              </div>
              
              <!-- Estado del Evento -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Estado del Evento</label>
                <div class="filter-checkboxes" id="filterEstadoPersonal">
                  <label><input type="checkbox" value="planificado" checked> Planificado</label>
                  <label><input type="checkbox" value="en_progreso" checked> En Progreso</label>
                  <label><input type="checkbox" value="completado" checked> Completado</label>
                  <label><input type="checkbox" value="cancelado" checked> Cancelado</label>
                </div>
              </div>
              
              <!-- Tipo de Actividad -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Tipo de Actividad</label>
                <div class="filter-checkboxes" id="filterTipoActividadPersonal">
                  <label><input type="checkbox" value="Capacitación" checked> Capacitación</label>
                  <label><input type="checkbox" value="Entrega" checked> Entrega</label>
                  <label><input type="checkbox" value="Proyecto de Ayuda" checked> Proyecto de Ayuda</label>
                </div>
              </div>
              
              <!-- Filtrar por Colaborador -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Filtrar por Colaborador</label>
                  <span class="toggle-icon" id="toggleIconColaboradoresPersonal" style="cursor: pointer;" onclick="toggleChecklist('colaboradoresPersonal')">▶</span>
                </div>
                <!-- Tags de colaboradores seleccionados (siempre visibles) -->
                <div id="selectedColaboradoresPersonalTags" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;">
                  <!-- Los colaboradores seleccionados aparecerán aquí como tags -->
                </div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchColaboradorPersonal" placeholder="Buscar colaborador...">
                </div>
                <div id="colaboradoresPersonalContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterColaboradoresPersonal" style="max-height: 200px; overflow-y: auto;">
                    <!-- Los colaboradores NO seleccionados se cargarán aquí dinámicamente -->
                  </div>
                </div>
              </div>
            </div>
            <div class="filters-actions">
              <button class="btn-secondary" onclick="resetFiltersForm('actividad-de-personal')">Limpiar Filtros</button>
              <button class="btn-primary" onclick="applyFiltersForm('actividad-de-personal')">Aplicar Filtros</button>
            </div>
          </div>
          
          <!-- Formulario: Avances de Eventos Generales -->
          <div class="report-form" id="form-avances-eventos-generales" style="display: none;">
            <div class="filters-grid">
              <!-- Período de Fechas -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Período de Fechas</label>
                <select class="filter-select" id="filterPeriodoAvances">
                  <option value="todo">Todo el tiempo</option>
                  <option value="ultimo_mes">Último mes</option>
                  <option value="ultima_semana">Esta última semana</option>
                  <option value="rango">Rango de fechas</option>
                </select>
                <div class="date-range-container" id="dateRangeAvances" style="display: none; margin-top: 12px;">
                  <div class="filter-group">
                    <label class="filter-label">Fecha Inicio</label>
                    <input type="date" class="filter-input" id="filterFechaInicioAvances">
                  </div>
                  <div class="filter-group">
                    <label class="filter-label">Fecha Fin</label>
                    <input type="date" class="filter-input" id="filterFechaFinAvances">
                  </div>
                </div>
              </div>
              
              <!-- Buscar Comunidad -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Buscar Comunidad</label>
                <div class="search-input-container">
                  <input type="text" class="filter-input filter-search" id="searchComunidadAvances" placeholder="Buscar comunidades...">
                  <div class="search-results" id="searchResultsComunidadAvances" style="display: none;"></div>
                </div>
              </div>
              
              <!-- Filtrar por Evento -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Filtrar por Evento</label>
                  <span class="toggle-icon" id="toggleIconEventosAvances" style="cursor: pointer;" onclick="toggleChecklist('eventosAvances')">▶</span>
                </div>
                <div id="selectedEventosAvancesTags" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;"></div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchEventoAvances" placeholder="Buscar evento...">
                </div>
                <div id="eventosAvancesContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterEventosAvances" style="max-height: 200px; overflow-y: auto;"></div>
                </div>
              </div>
              
              <!-- Tipo de Actividad -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Tipo de Actividad</label>
                <div class="filter-checkboxes" id="filterTipoActividadAvances">
                  <label><input type="checkbox" value="Capacitación" checked> Capacitación</label>
                  <label><input type="checkbox" value="Entrega" checked> Entrega</label>
                  <label><input type="checkbox" value="Proyecto de Ayuda" checked> Proyecto de Ayuda</label>
                </div>
              </div>
              
              <!-- Filtrar por Colaborador -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Filtrar por Colaborador</label>
                  <span class="toggle-icon" id="toggleIconColaboradoresAvances" style="cursor: pointer;" onclick="toggleChecklist('colaboradoresAvances')">▶</span>
                </div>
                <div id="selectedColaboradoresAvancesTags" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;"></div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchColaboradorAvances" placeholder="Buscar colaborador...">
                </div>
                <div id="colaboradoresAvancesContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterColaboradoresAvances" style="max-height: 200px; overflow-y: auto;"></div>
                </div>
              </div>
              
              <!-- Mostrar Archivos de Evidencias -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Mostrar Archivos de Evidencias</label>
                <div class="filter-checkboxes">
                  <label><input type="checkbox" id="filterMostrarEvidenciasAvances" checked> Sí</label>
                </div>
              </div>
            </div>
            <div class="filters-actions">
              <button class="btn-secondary" onclick="resetFiltersForm('avances-eventos-generales')">Limpiar Filtros</button>
              <button class="btn-primary" onclick="applyFiltersForm('avances-eventos-generales')">Aplicar Filtros</button>
            </div>
          </div>
          
          <!-- Formulario: Reporte de Evento Individual -->
          <div class="report-form" id="form-reporte-evento-individual" style="display: none;">
            <div class="filters-grid">
              <!-- Tipo de Actividad -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Tipo de Actividad</label>
                <div class="filter-checkboxes" id="filterTipoActividadIndividual">
                  <label><input type="checkbox" value="todos" checked> Todos</label>
                  <label><input type="checkbox" value="Capacitación"> Capacitación</label>
                  <label><input type="checkbox" value="Entrega"> Entrega</label>
                  <label><input type="checkbox" value="Proyecto de Ayuda"> Proyecto de Ayuda</label>
                </div>
              </div>
              
              <!-- Filtrar por Evento (solo uno) -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Seleccionar Evento</label>
                  <span class="toggle-icon" id="toggleIconEventoIndividual" style="cursor: pointer;" onclick="toggleChecklist('eventoIndividual')">▶</span>
                </div>
                <div id="selectedEventoIndividualTag" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;"></div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchEventoIndividual" placeholder="Buscar evento...">
                </div>
                <div id="eventoIndividualContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterEventoIndividual" style="max-height: 200px; overflow-y: auto;"></div>
                </div>
              </div>
            </div>
            <div class="filters-actions">
              <button class="btn-secondary" onclick="resetFiltersForm('reporte-evento-individual')">Limpiar Filtros</button>
              <button class="btn-primary" onclick="applyFiltersForm('reporte-evento-individual')">Aplicar Filtros</button>
            </div>
          </div>
          
          <!-- Formulario: Comunidades -->
          <div class="report-form" id="form-comunidades" style="display: none;">
            <div class="filters-grid">
              <!-- Periodo de Fechas -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Periodo de Fechas</label>
                <select class="filter-select" id="periodoComunidades">
                  <option value="todo">Todo el tiempo</option>
                  <option value="ultimo_mes">Último mes</option>
                  <option value="ultima_semana">Esta última semana</option>
                  <option value="rango">Rango de fechas</option>
                </select>
              </div>
              
              <!-- Rango de Fechas (oculto por defecto) -->
              <div class="filter-group" id="fechaInicioComunidades" style="display: none;">
                <label class="filter-label">Fecha Inicio</label>
                <input type="date" class="filter-input" id="filterFechaInicioComunidades">
              </div>
              <div class="filter-group" id="fechaFinComunidades" style="display: none;">
                <label class="filter-label">Fecha Fin</label>
                <input type="date" class="filter-input" id="filterFechaFinComunidades">
              </div>
              
              <!-- Tipo de Actividad -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Tipo de Actividad</label>
                <div class="filter-checkboxes" id="filterTipoActividadComunidades">
                  <label><input type="checkbox" value="todos" checked> Todos</label>
                  <label><input type="checkbox" value="Capacitación" checked> Capacitación</label>
                  <label><input type="checkbox" value="Entrega" checked> Entrega</label>
                  <label><input type="checkbox" value="Proyecto de Ayuda" checked> Proyecto de Ayuda</label>
                </div>
              </div>
              
              <!-- Filtrar por Evento/Proyecto (selección única) -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Filtrar por Evento/Proyecto</label>
                  <span class="toggle-icon" id="toggleIconEventoComunidades" style="cursor: pointer;" onclick="toggleChecklist('eventoComunidades')">▶</span>
                </div>
                <div id="selectedEventoComunidadesTag" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;"></div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchEventoComunidades" placeholder="Buscar evento/proyecto...">
                </div>
                <div id="eventoComunidadesContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterEventoComunidades" style="max-height: 200px; overflow-y: auto;"></div>
                </div>
                <p style="color: var(--text-70); font-size: 0.875rem; margin-top: 8px;">Si no se selecciona ningún evento, se buscará por comunidad (pueden aparecer varios proyectos por comunidad)</p>
              </div>
              
              <!-- Buscar Comunidad (múltiple, checklist) -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Buscar Comunidad</label>
                  <span class="toggle-icon" id="toggleIconComunidadComunidades" style="cursor: pointer;" onclick="toggleChecklist('comunidadComunidades')">▶</span>
                </div>
                <div id="selectedComunidadesComunidadesTags" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;"></div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchComunidadComunidades" placeholder="Buscar comunidades...">
                </div>
                <div id="comunidadComunidadesContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterComunidadComunidades" style="max-height: 200px; overflow-y: auto;"></div>
                </div>
                <p style="color: var(--text-70); font-size: 0.875rem; margin-top: 8px;">Debe seleccionar al menos una comunidad</p>
              </div>
            </div>
            <div class="filters-actions">
              <button class="btn-secondary" onclick="resetFiltersForm('comunidades')">Limpiar Filtros</button>
              <button class="btn-primary" onclick="applyFiltersForm('comunidades')">Aplicar Filtros</button>
            </div>
          </div>
          
          <!-- Formulario: Actividad de Usuarios -->
          <div class="report-form" id="form-actividad-usuarios" style="display: none;">
            <div class="filters-grid">
              <!-- Periodo de Fechas -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Periodo de Fechas</label>
                <select class="filter-select" id="periodoActividadUsuarios">
                  <option value="todo">Todo el tiempo</option>
                  <option value="ultimo_mes">Último mes</option>
                  <option value="ultima_semana">Esta última semana</option>
                  <option value="rango">Rango de fechas</option>
                </select>
              </div>
              
              <!-- Rango de Fechas (oculto por defecto) -->
              <div class="filter-group" id="fechaInicioActividadUsuarios" style="display: none;">
                <label class="filter-label">Fecha Inicio</label>
                <input type="date" class="filter-input" id="filterFechaInicioActividadUsuarios">
              </div>
              <div class="filter-group" id="fechaFinActividadUsuarios" style="display: none;">
                <label class="filter-label">Fecha Fin</label>
                <input type="date" class="filter-input" id="filterFechaFinActividadUsuarios">
              </div>
              
              <!-- Tipo de Actividad -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Tipo de Actividad</label>
                <div class="filter-checkboxes" id="filterTipoActividadActividadUsuarios">
                  <label><input type="checkbox" value="todos" checked> Todos</label>
                  <label><input type="checkbox" value="Capacitación" checked> Capacitación</label>
                  <label><input type="checkbox" value="Entrega" checked> Entrega</label>
                  <label><input type="checkbox" value="Proyecto de Ayuda" checked> Proyecto de Ayuda</label>
                </div>
              </div>
              
              <!-- Filtrar por Evento/Proyecto (selección única) -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Filtrar por Evento/Proyecto</label>
                  <span class="toggle-icon" id="toggleIconEventoActividadUsuarios" style="cursor: pointer;" onclick="toggleChecklist('eventoActividadUsuarios')">▶</span>
                </div>
                <div id="selectedEventoActividadUsuariosTag" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;"></div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchEventoActividadUsuarios" placeholder="Buscar evento/proyecto...">
                </div>
                <div id="eventoActividadUsuariosContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterEventoActividadUsuarios" style="max-height: 200px; overflow-y: auto;"></div>
                </div>
                <p style="color: var(--text-70); font-size: 0.875rem; margin-top: 8px;">Si no se selecciona ningún evento, se buscará por comunidad</p>
              </div>
              
              <!-- Buscar Comunidad (múltiple, checklist) -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Buscar Comunidad</label>
                  <span class="toggle-icon" id="toggleIconComunidadActividadUsuarios" style="cursor: pointer;" onclick="toggleChecklist('comunidadActividadUsuarios')">▶</span>
                </div>
                <div id="selectedComunidadesActividadUsuariosTags" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;"></div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchComunidadActividadUsuarios" placeholder="Buscar comunidades...">
                </div>
                <div id="comunidadActividadUsuariosContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterComunidadActividadUsuarios" style="max-height: 200px; overflow-y: auto;"></div>
                </div>
                <p style="color: var(--text-70); font-size: 0.875rem; margin-top: 8px;">Si no se selecciona ninguna comunidad, se buscará por eventos. Si ambos están vacíos, se buscará todo.</p>
              </div>
              
              <!-- Filtrar por Usuarios (múltiple, checklist) -->
              <div class="filter-group filter-group-full">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                  <label class="filter-label" style="margin-bottom: 0;">Filtrar por Usuarios</label>
                  <span class="toggle-icon" id="toggleIconUsuariosActividadUsuarios" style="cursor: pointer;" onclick="toggleChecklist('usuariosActividadUsuarios')">▶</span>
                </div>
                <div id="selectedUsuariosActividadUsuariosTags" class="selected-tags-container" style="margin-bottom: 12px; min-height: 0;"></div>
                <div class="search-input-container" style="margin-bottom: 12px;">
                  <input type="text" class="filter-input filter-search" id="searchUsuariosActividadUsuarios" placeholder="Buscar usuarios...">
                </div>
                <div id="usuariosActividadUsuariosContainer" style="display: none;">
                  <div class="filter-checkboxes" id="filterUsuariosActividadUsuarios" style="max-height: 200px; overflow-y: auto;"></div>
                </div>
                <p style="color: var(--text-70); font-size: 0.875rem; margin-top: 8px;">Usuarios del sistema y colaboradores vinculados. Si no se selecciona ninguno, se buscarán todos.</p>
              </div>
            </div>
            <div class="filters-actions">
              <button class="btn-secondary" onclick="resetFiltersForm('actividad-usuarios')">Limpiar Filtros</button>
              <button class="btn-primary" onclick="applyFiltersForm('actividad-usuarios')">Aplicar Filtros</button>
            </div>
          </div>
          
          <!-- Formulario genérico para otros reportes -->
          <div class="report-form" id="form-generic" style="display: none;">
            <div class="filters-grid">
              <div class="filter-group">
                <label class="filter-label">Fecha Inicio</label>
                <input type="date" class="filter-input" id="filterFechaInicio">
              </div>
              <div class="filter-group">
                <label class="filter-label">Fecha Fin</label>
                <input type="date" class="filter-input" id="filterFechaFin">
              </div>
              <div class="filter-group">
                <label class="filter-label">Región</label>
                <select class="filter-select" id="filterRegion" multiple>
                  <option value="">Cargando...</option>
                </select>
              </div>
              <div class="filter-group">
                <label class="filter-label">Comunidad</label>
                <select class="filter-select" id="filterComunidad" multiple>
                  <option value="">Seleccione primero una región</option>
                </select>
              </div>
              <div class="filter-group">
                <label class="filter-label">Estado</label>
                <div class="filter-checkboxes" id="filterEstadoCheckboxes">
                  <label><input type="checkbox" value="planificado" checked> Planificado</label>
                  <label><input type="checkbox" value="en_progreso" checked> En Progreso</label>
                  <label><input type="checkbox" value="completado" checked> Completado</label>
                  <label><input type="checkbox" value="cancelado" checked> Cancelado</label>
                </div>
              </div>
              <div class="filter-group">
                <label class="filter-label">Tipo de Actividad</label>
                <select class="filter-select" id="filterTipoActividad" multiple>
                  <option value="">Cargando...</option>
                </select>
              </div>
              <div class="filter-group">
                <label class="filter-label">Responsable</label>
                <select class="filter-select" id="filterResponsable">
                  <option value="">Todos</option>
                </select>
              </div>
              <div class="filter-group">
                <label class="filter-label">Tipo de Beneficiario</label>
                <div class="filter-checkboxes" id="filterTipoBeneficiarioCheckboxes">
                  <label><input type="checkbox" value="individual" checked> Individual</label>
                  <label><input type="checkbox" value="familia" checked> Familia</label>
                  <label><input type="checkbox" value="institución" checked> Institución</label>
                </div>
              </div>
            </div>
            <div class="filters-actions">
              <button class="btn-secondary" id="resetFiltersBtn">Limpiar Filtros</button>
              <button class="btn-primary" id="applyFiltersBtn">Aplicar Filtros</button>
            </div>
          </div>

          <!-- Formulario: Reporte General -->
          <div class="report-form" id="form-reporte-general" style="display: none;">
            <div class="filters-grid">
              <!-- Periodo de Fechas -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Periodo de Fechas</label>
                <select class="filter-select" id="periodoReporteGeneral">
                  <option value="todo">Todo el tiempo</option>
                  <option value="ultimo_mes">Último mes</option>
                  <option value="ultima_semana">Esta última semana</option>
                  <option value="rango">Rango de fechas</option>
                </select>
              </div>
              
              <!-- Rango de Fechas (oculto por defecto) -->
              <div class="filter-group" id="fechaInicioReporteGeneral" style="display: none;">
                <label class="filter-label">Fecha Inicio</label>
                <input type="date" class="filter-input" id="filterFechaInicioReporteGeneral">
              </div>
              <div class="filter-group" id="fechaFinReporteGeneral" style="display: none;">
                <label class="filter-label">Fecha Fin</label>
                <input type="date" class="filter-input" id="filterFechaFinReporteGeneral">
              </div>
              
              <!-- Checklist de Apartados -->
              <div class="filter-group filter-group-full">
                <label class="filter-label">Apartados a Incluir en el Reporte</label>
                <div class="filter-checkboxes" id="filterApartadosReporteGeneral">
                  <label><input type="checkbox" value="total_eventos" checked> Total de Eventos (con lista)</label>
                  <label><input type="checkbox" value="tipos_eventos" checked> Total de Tipos de Eventos</label>
                  <label><input type="checkbox" value="total_beneficiarios" checked> Total de Beneficiarios Alcanzados</label>
                  <label><input type="checkbox" value="tipos_beneficiarios" checked> Total de Tipos de Beneficiarios</label>
                  <label><input type="checkbox" value="total_comunidades" checked> Total de Comunidades Alcanzadas</label>
                  <label><input type="checkbox" value="total_avances" checked> Total de Avances en Proyectos</label>
                  <label><input type="checkbox" value="comunidades_mas_beneficiarios" checked> Comunidades con Más Beneficiarios y Eventos</label>
                  <label><input type="checkbox" value="eventos_mas_beneficiarios" checked> Eventos con Más Beneficiarios</label>
                  <label><input type="checkbox" value="evento_mas_avances" checked> Evento con Más Avances y Cambios</label>
                </div>
              </div>
            </div>
            <div class="filters-actions">
              <button class="btn-secondary" onclick="resetFiltersForm('reporte-general')">Limpiar Filtros</button>
              <button class="btn-primary" onclick="applyFiltersForm('reporte-general')">Aplicar Filtros</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Resultados -->
      <div class="results-content" id="resultsContent">
        <div class="export-buttons">
          <button class="btn-export" data-format="pdf" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Exportar PDF
          </button>
          <button class="btn-export" data-format="excel" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Exportar Excel
          </button>
          <button class="btn-export" data-format="word" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Exportar Word
          </button>
        </div>

        <div class="results-container" id="resultsContainer">
          <div class="loading-state">
            <div class="spinner"></div>
            <p>Generando reporte...</p>
          </div>
        </div>
      </div>
    </section>

  </div>
</main>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/reportes.js' %}?v=3.21"></script>
{% endblock %}

